# Database
DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=your_secure_password
DB_NAME=kamino
DB_SSLMODE=disable

# Connection Pool
DB_MAX_CONNS=25
DB_MIN_CONNS=5
DB_MAX_CONN_LIFETIME=5m
DB_MAX_CONN_IDLE_TIME=1m
DB_HEALTH_CHECK_PERIOD=1m

# Server
PORT=8080
ENV=development
LOG_LEVEL=info

# CORS Configuration
# CRITICAL: Required in production - comma-separated list of allowed origins
# Example: ALLOWED_ORIGINS=https://app.example.com,https://www.example.com
# Development: defaults to localhost variants if not set
ALLOWED_ORIGINS=

# Authentication (JWT)
# IMPORTANT: Use a strong random secret
# Minimum 16 characters in development, 32 characters in production
# Generate with: openssl rand -base64 32
JWT_SECRET=your_secure_jwt_secret_minimum_32_characters
ACCESS_TOKEN_EXPIRY=15m
REFRESH_TOKEN_EXPIRY=168h
TOKEN_CLEANUP_INTERVAL=1h

# Bootstrap Admin User (optional - will create on first run)
ADMIN_EMAIL=admin@kamino.com
ADMIN_PASSWORD=AdminSecurePass123

# Rate Limiting (Enhanced Security)
MAX_FAILED_ATTEMPTS_PER_EMAIL=5
EMAIL_LOCKOUT_DURATION=15m
MAX_ATTEMPTS_PER_IP=20
MAX_ATTEMPTS_PER_DEVICE=10
RATE_LIMIT_LOOKBACK_WINDOW=15m

# Cookie Configuration (Secure Token Storage)
# Empty domain = current host only (recommended for development)
# Set to your domain in production (e.g., ".example.com" for all subdomains)
COOKIE_DOMAIN=
COOKIE_SECURE=false
COOKIE_SAME_SITE=strict

# Timing Attack Prevention (Constant-Time Delays)
TIMING_DELAY_BASE_MS=500
TIMING_DELAY_RANDOM_MS=500
TIMING_DELAY_ON_SUCCESS=false
